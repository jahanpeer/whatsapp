<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title></title>
</head>
<body>
  <script type="text/javascript">
    window.onload = function () {
      function getParameterByName(name, url = window.location.href) {
        name = name.replace(/[\[\]]/g, '\\$&');
        var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
          results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, ' '));
      }

      var whatsappGroupLink = 'chat.whatsapp.com/';
      var fallbackURL = getParameterByName('u');
      
      if (fallbackURL) {
        if (fallbackURL.includes(whatsappGroupLink)) {
          // Process WhatsApp group link
          fallbackURL = fallbackURL; // No "https://" prefix added
        } else {
          // Handle other types of links without any fallback
          return;
        }
      } else {
        // Handle the case when there is no URL parameter
        return;
      }

      // Redirect logic for different devices
      var iosApp = 'whatsapp://send?text=' + encodeURIComponent('Join our WhatsApp group: ' + fallbackURL);
      var androidApp = 'intent://send?text=' + encodeURIComponent('Join our WhatsApp group: ' + fallbackURL) + '#Intent;package=com.whatsapp;scheme=whatsapp;end';

      if (/iPhone|iPad|iPod/i.test(navigator.userAgent)) {
        window.location.href = iosApp;
      } else if (/Android/i.test(navigator.userAgent)) {
        window.location.href = androidApp;
      } else {
        // Fallback for other devices
        window.location.href = fallbackURL;
      }

      function killPopup() {
        window.removeEventListener('pagehide', killPopup);
      }

      window.addEventListener('pagehide', killPopup);
    };
  </script>
</body>
</html>
